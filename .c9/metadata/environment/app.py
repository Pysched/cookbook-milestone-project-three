{"changed":true,"filter":false,"title":"app.py","tooltip":"/app.py","value":"import os, json, math, html\nimport re\nfrom flask import Flask, render_template, redirect, request, session, g, url_for, flash, Markup\nfrom flask_pymongo import PyMongo\nfrom bson.objectid import ObjectId\nfrom werkzeug.security import check_password_hash, generate_password_hash\nfrom datetime import date\nfrom flask_uploads import UploadSet, configure_uploads, IMAGES\n\n# Instance of Flask\napp = Flask(__name__)\n\n# Config for storing uploaded images\nimages = UploadSet('images', IMAGES)\napp.config[\"UPLOADED_IMAGES_DEST\"] = \"static/img\"\nconfigure_uploads(app, images)\n\n# Config Flask app and connect to database\napp.config[\"MONGO_DBNAME\"] = 'onlineCookbook'\napp.config[\"MONGO_URI\"] = os.getenv('MONGO_URI')\n# Secret key to enable user sessions for login and flash messages - generates random string\napp.secret_key = os.urandom(24)\n\n# Instance of PyMongo\nmongo = PyMongo(app)\n\n# DB collection variables\nrecipes_coll = mongo.db.recipes\nrating_coll = mongo.db.rating\ncategories_coll = mongo.db.categories\nserves_coll = mongo.db.serves\ntime_coll = mongo.db.time\ntypes_coll = mongo.db.types\noccasions_coll = mongo.db.occasions\ncuisines_coll = mongo.db.cuisines\nmain_ing_coll = mongo.db.main_ing\nusers_coll = mongo.db.userLogin\n\n# Functions for drop down menus (called multiple times in other functions)\ndef rating_dropdown():\n    '''\n    Drop down menu for rating values\n    Accesses rating array within the rating database\n    '''\n    return [\n        r for rating in rating_coll.find()\n        for r in rating.get(\"rating\")]\n\ndef time_dropdown():\n    '''\n    Drop down menu for time values (prep time and cook time)\n    Accesses time array within the time database\n    '''\n    return [\n        t for time in time_coll.find()\n        for t in time.get(\"time\")]\n\ndef serves_dropdown():\n    '''\n    Drop down menu for serves values (how many people the recipe serves)\n    Accesses serves array within the serves database\n    '''\n    return [\n        s for serves in serves_coll.find()\n        for s in serves.get(\"serves\")]\n\ndef types_dropdown():\n    '''\n    Drop down menu for types values\n    Accesses types array within the types database\n    '''\n    return [\n        t for types in types_coll.find()\n        for t in types.get(\"types\")]\n\ndef occasions_dropdown():\n    '''\n    Drop down menu for occasions values\n    Accesses occasions array within the occasions database\n    '''\n    return [\n        o for occ in occasions_coll.find()\n        for o in occ.get(\"occasions\")]\n\ndef cuisines_dropdown():\n    '''\n    Drop down menu for cusines values\n    Accesses cusines array within the cusines database\n    '''\n    return [\n        c for cuisine in cuisines_coll.find()\n        for c in cuisine.get(\"cuisines\")]\n\ndef main_ing_dropdown():\n    '''\n    Drop down menu for main_ing values\n    Accesses main_ing array within the main_ing database\n    '''\n    return [\n        m for main in main_ing_coll.find()\n        for m in main.get(\"main_ing\")]\n\n# Other global variables (called in multiple functions)\nrating_list = rating_dropdown()\ntime_list = time_dropdown()\nserves_list = serves_dropdown()\ntypes_list = types_dropdown()\noccasions_list = occasions_dropdown()\ncuisines_list = cuisines_dropdown()\nmain_ing_list = main_ing_dropdown()\n\n# Other helper functions (called multiple times in other functions)\n\n# Route to index.html\n@app.route('/')\ndef index():\n    return render_template(\"index.html\")\n\n# User login sessions/logout\n@app.route('/login_register')\ndef login_register():\n    return render_template(\"login_register.html\")\n    \n@app.route('/login', methods=[\"GET\", \"POST\"])\ndef login():\n    '''\n    Login\n    Checks that the user exists, and that user's password matches the\n    hased password in the database\n    '''\n    if request.method == \"POST\":\n        \n        username = request.form.get('username').lower()\n        password = request.form.get(\"password\")\n        existing_user = users_coll.find_one({\"username\": username})\n        \n        # Check if username exists and user's password matches the hashed password\n        if existing_user and check_password_hash(existing_user[\"password\"], password):\n            flash(Markup(\"Welcome back \" + username + \", you're now logged in!\"))\n            session['user'] = username\n            return redirect(url_for('index'))\n        # If either the username or password don't match, generic flash message is displayed\n        else:\n            flash(Markup(\"It appears those details don't match what we have, please try again.\"))\n            return redirect(url_for('login'))\n            \n    return render_template(\"login_register.html\")\n\n@app.route('/register', methods=[\"GET\", \"POST\"])\ndef register():\n    '''\n    Create new user/register new account\n    Checks that the user doesn't already exist, and that length of username\n    and password is between 6-15 characters\n    Uses generate_password_hash to hash user's password in the database\n    '''\n    if request.method == \"POST\":\n        \n        new_username = request.form.get('new_username').lower()\n        new_password = request.form.get(\"new_password\")\n        \n        # Check username and password are alphanumeric\n        for letter in new_username:\n            if not letter.isalnum():\n                flash(Markup(\"Usernames must be alphanumeric only. Please try another one.\"))\n                return redirect(url_for('register'))\n        for letter in new_password:\n            if not letter.isalnum():\n                flash(Markup(\"Passwords must be alphanumeric only. Please try another one.\"))\n                return redirect(url_for('register'))\n        \n        # Check username and password are between 6-15 characters\n        if len(new_username) < 5 or len(new_username) > 15:\n            flash(Markup(\"Usernames must be between 5 and 15 characters. Please try again.\"))\n            return redirect(url_for('register'))\n        if len(new_password) < 5 or len(new_password) > 15:\n            flash(Markup(\"Passwords must be between 5 and 15 characters. Please try again.\"))\n            return redirect(url_for('register'))\n        \n        # Check if username already exists\n        existing_user = users_coll.find_one({\"username\": new_username})\n        if existing_user:\n            flash(Markup(\"Sorry, \" + new_username + \" is already taken! Please choose another one!\"))\n            return redirect(url_for('register'))\n        \n        # If all checks pass, add user to the database and hash the password\n        users_coll.insert_one({\n            \"username\": new_username,\n            \"password\": generate_password_hash(new_password)\n        })\n        session['user'] = new_username\n        flash(Markup(\"Welcome \" + new_username + \", you're now logged in!\"))\n        return redirect(url_for('index'))\n    \n    return render_template(\"login_register.html\")\n\n@app.route('/logout')\ndef logout():\n    '''\n    Remove the session cookie and end the user session\n    '''\n    session.pop('user', None)\n    flash(Markup(\"You were successfully logged out\"))\n    return redirect(url_for('index'))\n\n@app.before_request\ndef before_request():\n    '''\n    Checks if the user is logged in before each request\n    '''\n    g.user = None\n    if 'user' in session:\n        g.user = session['user']\n\n# Route to add_recipe.html\n@app.route('/add_recipe')\ndef add_recipe():\n    '''\n    Return the add_recipe.html template and inject the data into drop down menus\n    '''\n    return render_template(\"add_recipe.html\",\n        rating=rating_list,\n        time=time_list,\n        serves=serves_list,\n        types=types_list,\n        occasions=occasions_list,\n        cuisines=cuisines_list,\n        main_ing=main_ing_list)\n\n@app.route('/insert_recipe', methods=[\"GET\", \"POST\"])\ndef insert_recipe():\n    '''\n    Insert the new recipe entry into the database\n    '''\n    if request.method == 'POST':\n        # Check if user has submitted an recipe\n        if 'img' in request.files:\n            # If user has submitted an image,\n            # save to location and upload relative file path to database\n            file_name = images.save(request.files['img'])\n            file_path = \"..static/img/\" + file_name\n        else:\n            # If no image, stock image file path will be stored in database\n            file_path = \"..static/img/no-image-available.jpg\"\n        \n        # Get today's date\n        today = date.today()\n        today_date = today.strftime(\"%d %B %Y\")\n        \n        # Get session user details\n        user = session['user'].lower()\n        user_id = users_coll.find_one({\"username\": user})[\"_id\"]\n        \n        insert = {\n            \"name\": request.form.get(\"name\").lower(),\n            \"rating_values\": request.form.getlist(\"rating\"),\n            \"prep_time\": request.form.get(\"prep_time\").lower(),\n            \"cook_time\": request.form.get(\"cook_time\").lower(),\n            \"serves\": request.form.get(\"serves\").lower(),\n            \"ingredients\": request.form.getlist(\"ingredients\"),\n            \"instructions\": request.form.getlist(\"instructions\"),\n            \"type\": request.form.get(\"type\").lower(),\n            \"occasion\": request.form.get(\"occasion\").lower(),\n            \"cuisine\": request.form.get(\"cuisine\").lower(),\n            \"main_ing\": request.form.get(\"main_ing\").lower(),\n            \"author\": request.form.get(\"author\").lower(),\n            \"img\": file_path,\n            \"added_by\": user_id,\n            \"added_date\": today_date,\n            \"views\": 0,\n            \"deleted\": False\n        }\n        \n        # Insert recipe dict into the database\n        recipes_coll.insert_one(insert)\n        \n        # Flash message confirmation that recipe has been successfully added\n        flash(Markup(\"Thanks \" + user.capitalize() + \", your recipe has been added!\"))\n        \n        return redirect(url_for('index'))\n\nif __name__ == '__main__':\n    app.run(host=os.getenv(\"IP\", \"0.0.0.0\"),\n            port=int(os.getenv(\"PORT\", \"5000\")),\n            debug=False)","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":273,"column":33},"end":{"row":273,"column":34},"action":"insert","lines":[" "],"id":2373},{"start":{"row":273,"column":34},"end":{"row":273,"column":35},"action":"insert","lines":["t"]},{"start":{"row":273,"column":35},"end":{"row":273,"column":36},"action":"insert","lines":["h"]},{"start":{"row":273,"column":36},"end":{"row":273,"column":37},"action":"insert","lines":["e"]}],[{"start":{"row":273,"column":37},"end":{"row":273,"column":38},"action":"insert","lines":[" "],"id":2374},{"start":{"row":273,"column":38},"end":{"row":273,"column":39},"action":"insert","lines":["d"]},{"start":{"row":273,"column":39},"end":{"row":273,"column":40},"action":"insert","lines":["a"]},{"start":{"row":273,"column":40},"end":{"row":273,"column":41},"action":"insert","lines":["t"]}],[{"start":{"row":273,"column":41},"end":{"row":273,"column":42},"action":"insert","lines":["a"],"id":2375},{"start":{"row":273,"column":42},"end":{"row":273,"column":43},"action":"insert","lines":["b"]},{"start":{"row":273,"column":43},"end":{"row":273,"column":44},"action":"insert","lines":["a"]},{"start":{"row":273,"column":44},"end":{"row":273,"column":45},"action":"insert","lines":["s"]},{"start":{"row":273,"column":45},"end":{"row":273,"column":46},"action":"insert","lines":["e"]}],[{"start":{"row":274,"column":18},"end":{"row":274,"column":19},"action":"insert","lines":[" "],"id":2376},{"start":{"row":274,"column":19},"end":{"row":274,"column":20},"action":"insert","lines":["="]}],[{"start":{"row":274,"column":20},"end":{"row":274,"column":21},"action":"insert","lines":[" "],"id":2377}],[{"start":{"row":274,"column":21},"end":{"row":274,"column":22},"action":"insert","lines":["r"],"id":2378},{"start":{"row":274,"column":22},"end":{"row":274,"column":23},"action":"insert","lines":["e"]},{"start":{"row":274,"column":23},"end":{"row":274,"column":24},"action":"insert","lines":["c"]},{"start":{"row":274,"column":24},"end":{"row":274,"column":25},"action":"insert","lines":["i"]}],[{"start":{"row":274,"column":21},"end":{"row":274,"column":25},"action":"remove","lines":["reci"],"id":2379},{"start":{"row":274,"column":21},"end":{"row":274,"column":33},"action":"insert","lines":["recipes_coll"]}],[{"start":{"row":274,"column":33},"end":{"row":274,"column":35},"action":"insert","lines":["()"],"id":2380}],[{"start":{"row":274,"column":33},"end":{"row":274,"column":35},"action":"remove","lines":["()"],"id":2381}],[{"start":{"row":274,"column":33},"end":{"row":274,"column":34},"action":"insert","lines":["."],"id":2382},{"start":{"row":274,"column":34},"end":{"row":274,"column":35},"action":"insert","lines":["i"]},{"start":{"row":274,"column":35},"end":{"row":274,"column":36},"action":"insert","lines":["n"]},{"start":{"row":274,"column":36},"end":{"row":274,"column":37},"action":"insert","lines":["s"]},{"start":{"row":274,"column":37},"end":{"row":274,"column":38},"action":"insert","lines":["e"]},{"start":{"row":274,"column":38},"end":{"row":274,"column":39},"action":"insert","lines":["t"]}],[{"start":{"row":274,"column":38},"end":{"row":274,"column":39},"action":"remove","lines":["t"],"id":2383}],[{"start":{"row":274,"column":38},"end":{"row":274,"column":39},"action":"insert","lines":["r"],"id":2384},{"start":{"row":274,"column":39},"end":{"row":274,"column":40},"action":"insert","lines":["t"]},{"start":{"row":274,"column":40},"end":{"row":274,"column":41},"action":"insert","lines":["_"]},{"start":{"row":274,"column":41},"end":{"row":274,"column":42},"action":"insert","lines":["o"]},{"start":{"row":274,"column":42},"end":{"row":274,"column":43},"action":"insert","lines":["n"]},{"start":{"row":274,"column":43},"end":{"row":274,"column":44},"action":"insert","lines":["e"]}],[{"start":{"row":274,"column":44},"end":{"row":274,"column":46},"action":"insert","lines":["()"],"id":2385}],[{"start":{"row":274,"column":45},"end":{"row":274,"column":46},"action":"insert","lines":["i"],"id":2386},{"start":{"row":274,"column":46},"end":{"row":274,"column":47},"action":"insert","lines":["n"]},{"start":{"row":274,"column":47},"end":{"row":274,"column":48},"action":"insert","lines":["s"]},{"start":{"row":274,"column":48},"end":{"row":274,"column":49},"action":"insert","lines":["e"]},{"start":{"row":274,"column":49},"end":{"row":274,"column":50},"action":"insert","lines":["r"]},{"start":{"row":274,"column":50},"end":{"row":274,"column":51},"action":"insert","lines":["t"]}],[{"start":{"row":274,"column":52},"end":{"row":275,"column":0},"action":"insert","lines":["",""],"id":2387},{"start":{"row":275,"column":0},"end":{"row":275,"column":8},"action":"insert","lines":["        "]},{"start":{"row":275,"column":8},"end":{"row":276,"column":0},"action":"insert","lines":["",""]},{"start":{"row":276,"column":0},"end":{"row":276,"column":8},"action":"insert","lines":["        "]},{"start":{"row":276,"column":8},"end":{"row":276,"column":9},"action":"insert","lines":["#"]}],[{"start":{"row":276,"column":9},"end":{"row":276,"column":10},"action":"insert","lines":[" "],"id":2388},{"start":{"row":276,"column":10},"end":{"row":276,"column":11},"action":"insert","lines":["F"]},{"start":{"row":276,"column":11},"end":{"row":276,"column":12},"action":"insert","lines":["l"]},{"start":{"row":276,"column":12},"end":{"row":276,"column":13},"action":"insert","lines":["a"]},{"start":{"row":276,"column":13},"end":{"row":276,"column":14},"action":"insert","lines":["s"]},{"start":{"row":276,"column":14},"end":{"row":276,"column":15},"action":"insert","lines":["h"]}],[{"start":{"row":276,"column":15},"end":{"row":276,"column":16},"action":"insert","lines":[" "],"id":2389},{"start":{"row":276,"column":16},"end":{"row":276,"column":17},"action":"insert","lines":["m"]},{"start":{"row":276,"column":17},"end":{"row":276,"column":18},"action":"insert","lines":["e"]},{"start":{"row":276,"column":18},"end":{"row":276,"column":19},"action":"insert","lines":["s"]},{"start":{"row":276,"column":19},"end":{"row":276,"column":20},"action":"insert","lines":["s"]},{"start":{"row":276,"column":20},"end":{"row":276,"column":21},"action":"insert","lines":["a"]},{"start":{"row":276,"column":21},"end":{"row":276,"column":22},"action":"insert","lines":["g"]},{"start":{"row":276,"column":22},"end":{"row":276,"column":23},"action":"insert","lines":["e"]}],[{"start":{"row":276,"column":23},"end":{"row":276,"column":24},"action":"insert","lines":[" "],"id":2390},{"start":{"row":276,"column":24},"end":{"row":276,"column":25},"action":"insert","lines":["c"]},{"start":{"row":276,"column":25},"end":{"row":276,"column":26},"action":"insert","lines":["o"]},{"start":{"row":276,"column":26},"end":{"row":276,"column":27},"action":"insert","lines":["n"]},{"start":{"row":276,"column":27},"end":{"row":276,"column":28},"action":"insert","lines":["f"]},{"start":{"row":276,"column":28},"end":{"row":276,"column":29},"action":"insert","lines":["i"]},{"start":{"row":276,"column":29},"end":{"row":276,"column":30},"action":"insert","lines":["r"]},{"start":{"row":276,"column":30},"end":{"row":276,"column":31},"action":"insert","lines":["m"]},{"start":{"row":276,"column":31},"end":{"row":276,"column":32},"action":"insert","lines":["a"]},{"start":{"row":276,"column":32},"end":{"row":276,"column":33},"action":"insert","lines":["t"]},{"start":{"row":276,"column":33},"end":{"row":276,"column":34},"action":"insert","lines":["i"]},{"start":{"row":276,"column":34},"end":{"row":276,"column":35},"action":"insert","lines":["o"]},{"start":{"row":276,"column":35},"end":{"row":276,"column":36},"action":"insert","lines":["n"]}],[{"start":{"row":276,"column":36},"end":{"row":276,"column":37},"action":"insert","lines":[" "],"id":2391},{"start":{"row":276,"column":37},"end":{"row":276,"column":38},"action":"insert","lines":["t"]},{"start":{"row":276,"column":38},"end":{"row":276,"column":39},"action":"insert","lines":["h"]},{"start":{"row":276,"column":39},"end":{"row":276,"column":40},"action":"insert","lines":["a"]},{"start":{"row":276,"column":40},"end":{"row":276,"column":41},"action":"insert","lines":["t"]}],[{"start":{"row":276,"column":41},"end":{"row":276,"column":42},"action":"insert","lines":[" "],"id":2392},{"start":{"row":276,"column":42},"end":{"row":276,"column":43},"action":"insert","lines":["e"]},{"start":{"row":276,"column":43},"end":{"row":276,"column":44},"action":"insert","lines":["c"]}],[{"start":{"row":276,"column":43},"end":{"row":276,"column":44},"action":"remove","lines":["c"],"id":2393},{"start":{"row":276,"column":42},"end":{"row":276,"column":43},"action":"remove","lines":["e"]}],[{"start":{"row":276,"column":42},"end":{"row":276,"column":43},"action":"insert","lines":["r"],"id":2394},{"start":{"row":276,"column":43},"end":{"row":276,"column":44},"action":"insert","lines":["e"]},{"start":{"row":276,"column":44},"end":{"row":276,"column":45},"action":"insert","lines":["c"]},{"start":{"row":276,"column":45},"end":{"row":276,"column":46},"action":"insert","lines":["i"]},{"start":{"row":276,"column":46},"end":{"row":276,"column":47},"action":"insert","lines":["p"]},{"start":{"row":276,"column":47},"end":{"row":276,"column":48},"action":"insert","lines":["e"]}],[{"start":{"row":276,"column":48},"end":{"row":276,"column":49},"action":"insert","lines":[" "],"id":2395},{"start":{"row":276,"column":49},"end":{"row":276,"column":50},"action":"insert","lines":["h"]},{"start":{"row":276,"column":50},"end":{"row":276,"column":51},"action":"insert","lines":["a"]},{"start":{"row":276,"column":51},"end":{"row":276,"column":52},"action":"insert","lines":["s"]}],[{"start":{"row":276,"column":52},"end":{"row":276,"column":53},"action":"insert","lines":[" "],"id":2396},{"start":{"row":276,"column":53},"end":{"row":276,"column":54},"action":"insert","lines":["b"]},{"start":{"row":276,"column":54},"end":{"row":276,"column":55},"action":"insert","lines":["e"]},{"start":{"row":276,"column":55},"end":{"row":276,"column":56},"action":"insert","lines":["e"]},{"start":{"row":276,"column":56},"end":{"row":276,"column":57},"action":"insert","lines":["n"]}],[{"start":{"row":276,"column":57},"end":{"row":276,"column":58},"action":"insert","lines":[" "],"id":2397},{"start":{"row":276,"column":58},"end":{"row":276,"column":59},"action":"insert","lines":["s"]},{"start":{"row":276,"column":59},"end":{"row":276,"column":60},"action":"insert","lines":["u"]},{"start":{"row":276,"column":60},"end":{"row":276,"column":61},"action":"insert","lines":["c"]},{"start":{"row":276,"column":61},"end":{"row":276,"column":62},"action":"insert","lines":["c"]},{"start":{"row":276,"column":62},"end":{"row":276,"column":63},"action":"insert","lines":["e"]},{"start":{"row":276,"column":63},"end":{"row":276,"column":64},"action":"insert","lines":["s"]},{"start":{"row":276,"column":64},"end":{"row":276,"column":65},"action":"insert","lines":["s"]},{"start":{"row":276,"column":65},"end":{"row":276,"column":66},"action":"insert","lines":["f"]},{"start":{"row":276,"column":66},"end":{"row":276,"column":67},"action":"insert","lines":["u"]},{"start":{"row":276,"column":67},"end":{"row":276,"column":68},"action":"insert","lines":["l"]}],[{"start":{"row":276,"column":68},"end":{"row":276,"column":69},"action":"insert","lines":["l"],"id":2398},{"start":{"row":276,"column":69},"end":{"row":276,"column":70},"action":"insert","lines":["y"]}],[{"start":{"row":276,"column":70},"end":{"row":276,"column":71},"action":"insert","lines":[" "],"id":2399},{"start":{"row":276,"column":71},"end":{"row":276,"column":72},"action":"insert","lines":["a"]},{"start":{"row":276,"column":72},"end":{"row":276,"column":73},"action":"insert","lines":["d"]},{"start":{"row":276,"column":73},"end":{"row":276,"column":74},"action":"insert","lines":["d"]},{"start":{"row":276,"column":74},"end":{"row":276,"column":75},"action":"insert","lines":["e"]},{"start":{"row":276,"column":75},"end":{"row":276,"column":76},"action":"insert","lines":["d"]}],[{"start":{"row":276,"column":76},"end":{"row":277,"column":0},"action":"insert","lines":["",""],"id":2400},{"start":{"row":277,"column":0},"end":{"row":277,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":277,"column":8},"end":{"row":277,"column":77},"action":"insert","lines":["flash(Markup(\"Welcome back \" + username + \", you're now logged in!\"))"],"id":2401}],[{"start":{"row":277,"column":22},"end":{"row":277,"column":34},"action":"remove","lines":["Welcome back"],"id":2402},{"start":{"row":277,"column":22},"end":{"row":277,"column":23},"action":"insert","lines":["T"]},{"start":{"row":277,"column":23},"end":{"row":277,"column":24},"action":"insert","lines":["h"]},{"start":{"row":277,"column":24},"end":{"row":277,"column":25},"action":"insert","lines":["a"]},{"start":{"row":277,"column":25},"end":{"row":277,"column":26},"action":"insert","lines":["n"]},{"start":{"row":277,"column":26},"end":{"row":277,"column":27},"action":"insert","lines":["k"]},{"start":{"row":277,"column":27},"end":{"row":277,"column":28},"action":"insert","lines":["s"]}],[{"start":{"row":277,"column":41},"end":{"row":277,"column":42},"action":"insert","lines":["."],"id":2403},{"start":{"row":277,"column":42},"end":{"row":277,"column":43},"action":"insert","lines":["c"]},{"start":{"row":277,"column":43},"end":{"row":277,"column":44},"action":"insert","lines":["a"]}],[{"start":{"row":277,"column":44},"end":{"row":277,"column":46},"action":"insert","lines":["[]"],"id":2404}],[{"start":{"row":277,"column":45},"end":{"row":277,"column":46},"action":"insert","lines":["i"],"id":2405}],[{"start":{"row":277,"column":45},"end":{"row":277,"column":46},"action":"remove","lines":["i"],"id":2406},{"start":{"row":277,"column":44},"end":{"row":277,"column":46},"action":"remove","lines":["[]"]}],[{"start":{"row":277,"column":44},"end":{"row":277,"column":45},"action":"insert","lines":["p"],"id":2407},{"start":{"row":277,"column":45},"end":{"row":277,"column":46},"action":"insert","lines":["i"]},{"start":{"row":277,"column":46},"end":{"row":277,"column":47},"action":"insert","lines":["t"]},{"start":{"row":277,"column":47},"end":{"row":277,"column":48},"action":"insert","lines":["a"]},{"start":{"row":277,"column":48},"end":{"row":277,"column":49},"action":"insert","lines":["l"]}],[{"start":{"row":277,"column":49},"end":{"row":277,"column":50},"action":"insert","lines":["z"],"id":2408},{"start":{"row":277,"column":50},"end":{"row":277,"column":51},"action":"insert","lines":["e"]}],[{"start":{"row":277,"column":51},"end":{"row":277,"column":53},"action":"insert","lines":["()"],"id":2409}],[{"start":{"row":277,"column":37},"end":{"row":277,"column":41},"action":"remove","lines":["name"],"id":2410}],[{"start":{"row":277,"column":58},"end":{"row":277,"column":75},"action":"remove","lines":["'re now logged in"],"id":2411},{"start":{"row":277,"column":58},"end":{"row":277,"column":59},"action":"insert","lines":["r"]}],[{"start":{"row":277,"column":59},"end":{"row":277,"column":60},"action":"insert","lines":[" "],"id":2412},{"start":{"row":277,"column":60},"end":{"row":277,"column":61},"action":"insert","lines":["r"]},{"start":{"row":277,"column":61},"end":{"row":277,"column":62},"action":"insert","lines":["e"]},{"start":{"row":277,"column":62},"end":{"row":277,"column":63},"action":"insert","lines":["c"]},{"start":{"row":277,"column":63},"end":{"row":277,"column":64},"action":"insert","lines":["i"]},{"start":{"row":277,"column":64},"end":{"row":277,"column":65},"action":"insert","lines":["p"]},{"start":{"row":277,"column":65},"end":{"row":277,"column":66},"action":"insert","lines":["e"]}],[{"start":{"row":277,"column":66},"end":{"row":277,"column":67},"action":"insert","lines":[" "],"id":2413},{"start":{"row":277,"column":67},"end":{"row":277,"column":68},"action":"insert","lines":["h"]},{"start":{"row":277,"column":68},"end":{"row":277,"column":69},"action":"insert","lines":["a"]},{"start":{"row":277,"column":69},"end":{"row":277,"column":70},"action":"insert","lines":["s"]}],[{"start":{"row":277,"column":70},"end":{"row":277,"column":71},"action":"insert","lines":[" "],"id":2414},{"start":{"row":277,"column":71},"end":{"row":277,"column":72},"action":"insert","lines":["b"]},{"start":{"row":277,"column":72},"end":{"row":277,"column":73},"action":"insert","lines":["e"]},{"start":{"row":277,"column":73},"end":{"row":277,"column":74},"action":"insert","lines":["e"]},{"start":{"row":277,"column":74},"end":{"row":277,"column":75},"action":"insert","lines":["n"]}],[{"start":{"row":277,"column":75},"end":{"row":277,"column":76},"action":"insert","lines":[" "],"id":2415},{"start":{"row":277,"column":76},"end":{"row":277,"column":77},"action":"insert","lines":["a"]},{"start":{"row":277,"column":77},"end":{"row":277,"column":78},"action":"insert","lines":["d"]},{"start":{"row":277,"column":78},"end":{"row":277,"column":79},"action":"insert","lines":["d"]},{"start":{"row":277,"column":79},"end":{"row":277,"column":80},"action":"insert","lines":["e"]},{"start":{"row":277,"column":80},"end":{"row":277,"column":81},"action":"insert","lines":["d"]}],[{"start":{"row":277,"column":85},"end":{"row":278,"column":0},"action":"insert","lines":["",""],"id":2416},{"start":{"row":278,"column":0},"end":{"row":278,"column":8},"action":"insert","lines":["        "]},{"start":{"row":278,"column":8},"end":{"row":279,"column":0},"action":"insert","lines":["",""]},{"start":{"row":279,"column":0},"end":{"row":279,"column":8},"action":"insert","lines":["        "]},{"start":{"row":279,"column":8},"end":{"row":279,"column":9},"action":"insert","lines":["r"]},{"start":{"row":279,"column":9},"end":{"row":279,"column":10},"action":"insert","lines":["e"]},{"start":{"row":279,"column":10},"end":{"row":279,"column":11},"action":"insert","lines":["t"]},{"start":{"row":279,"column":11},"end":{"row":279,"column":12},"action":"insert","lines":["u"]},{"start":{"row":279,"column":12},"end":{"row":279,"column":13},"action":"insert","lines":["r"]},{"start":{"row":279,"column":13},"end":{"row":279,"column":14},"action":"insert","lines":["n"]}],[{"start":{"row":279,"column":14},"end":{"row":279,"column":15},"action":"insert","lines":["r"],"id":2417},{"start":{"row":279,"column":15},"end":{"row":279,"column":16},"action":"insert","lines":["e"]}],[{"start":{"row":279,"column":15},"end":{"row":279,"column":16},"action":"remove","lines":["e"],"id":2418},{"start":{"row":279,"column":14},"end":{"row":279,"column":15},"action":"remove","lines":["r"]}],[{"start":{"row":279,"column":14},"end":{"row":279,"column":15},"action":"insert","lines":[" "],"id":2419},{"start":{"row":279,"column":15},"end":{"row":279,"column":16},"action":"insert","lines":["r"]},{"start":{"row":279,"column":16},"end":{"row":279,"column":17},"action":"insert","lines":["e"]},{"start":{"row":279,"column":17},"end":{"row":279,"column":18},"action":"insert","lines":["d"]},{"start":{"row":279,"column":18},"end":{"row":279,"column":19},"action":"insert","lines":["u"]}],[{"start":{"row":279,"column":18},"end":{"row":279,"column":19},"action":"remove","lines":["u"],"id":2420},{"start":{"row":279,"column":17},"end":{"row":279,"column":18},"action":"remove","lines":["d"]}],[{"start":{"row":279,"column":17},"end":{"row":279,"column":18},"action":"insert","lines":["d"],"id":2421},{"start":{"row":279,"column":18},"end":{"row":279,"column":19},"action":"insert","lines":["i"]},{"start":{"row":279,"column":19},"end":{"row":279,"column":20},"action":"insert","lines":["r"]},{"start":{"row":279,"column":20},"end":{"row":279,"column":21},"action":"insert","lines":["e"]},{"start":{"row":279,"column":21},"end":{"row":279,"column":22},"action":"insert","lines":["c"]},{"start":{"row":279,"column":22},"end":{"row":279,"column":23},"action":"insert","lines":["t"]}],[{"start":{"row":279,"column":22},"end":{"row":279,"column":23},"action":"remove","lines":["t"],"id":2422}],[{"start":{"row":279,"column":22},"end":{"row":279,"column":23},"action":"insert","lines":["t"],"id":2423},{"start":{"row":279,"column":23},"end":{"row":279,"column":24},"action":"insert","lines":["_"]}],[{"start":{"row":279,"column":23},"end":{"row":279,"column":24},"action":"remove","lines":["_"],"id":2424}],[{"start":{"row":279,"column":23},"end":{"row":279,"column":25},"action":"insert","lines":["()"],"id":2425}],[{"start":{"row":279,"column":24},"end":{"row":279,"column":25},"action":"insert","lines":["u"],"id":2426},{"start":{"row":279,"column":25},"end":{"row":279,"column":26},"action":"insert","lines":["r"]},{"start":{"row":279,"column":26},"end":{"row":279,"column":27},"action":"insert","lines":["l"]},{"start":{"row":279,"column":27},"end":{"row":279,"column":28},"action":"insert","lines":["_"]},{"start":{"row":279,"column":28},"end":{"row":279,"column":29},"action":"insert","lines":["f"]},{"start":{"row":279,"column":29},"end":{"row":279,"column":30},"action":"insert","lines":["o"]},{"start":{"row":279,"column":30},"end":{"row":279,"column":31},"action":"insert","lines":["r"]}],[{"start":{"row":279,"column":31},"end":{"row":279,"column":33},"action":"insert","lines":["()"],"id":2427}],[{"start":{"row":279,"column":32},"end":{"row":279,"column":34},"action":"insert","lines":["\"\""],"id":2428}],[{"start":{"row":279,"column":33},"end":{"row":279,"column":34},"action":"insert","lines":["i"],"id":2429},{"start":{"row":279,"column":34},"end":{"row":279,"column":35},"action":"insert","lines":["n"]},{"start":{"row":279,"column":35},"end":{"row":279,"column":36},"action":"insert","lines":["d"]},{"start":{"row":279,"column":36},"end":{"row":279,"column":37},"action":"insert","lines":["e"]},{"start":{"row":279,"column":37},"end":{"row":279,"column":38},"action":"insert","lines":["x"]},{"start":{"row":279,"column":38},"end":{"row":279,"column":39},"action":"insert","lines":["."]},{"start":{"row":279,"column":39},"end":{"row":279,"column":40},"action":"insert","lines":["h"]},{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"insert","lines":["t"]}],[{"start":{"row":279,"column":41},"end":{"row":279,"column":42},"action":"insert","lines":["m"],"id":2430},{"start":{"row":279,"column":42},"end":{"row":279,"column":43},"action":"insert","lines":["l"]}],[{"start":{"row":279,"column":33},"end":{"row":279,"column":43},"action":"remove","lines":["index.html"],"id":2431},{"start":{"row":279,"column":33},"end":{"row":279,"column":34},"action":"insert","lines":["i"]},{"start":{"row":279,"column":34},"end":{"row":279,"column":35},"action":"insert","lines":["n"]},{"start":{"row":279,"column":35},"end":{"row":279,"column":36},"action":"insert","lines":["d"]},{"start":{"row":279,"column":36},"end":{"row":279,"column":37},"action":"insert","lines":["e"]},{"start":{"row":279,"column":37},"end":{"row":279,"column":38},"action":"insert","lines":["c"]}],[{"start":{"row":279,"column":37},"end":{"row":279,"column":38},"action":"remove","lines":["c"],"id":2432}],[{"start":{"row":279,"column":37},"end":{"row":279,"column":38},"action":"insert","lines":["x"],"id":2433}],[{"start":{"row":279,"column":38},"end":{"row":279,"column":39},"action":"remove","lines":["\""],"id":2434}],[{"start":{"row":279,"column":38},"end":{"row":279,"column":39},"action":"insert","lines":["'"],"id":2435}],[{"start":{"row":279,"column":32},"end":{"row":279,"column":33},"action":"remove","lines":["\""],"id":2436}],[{"start":{"row":279,"column":32},"end":{"row":279,"column":33},"action":"insert","lines":["'"],"id":2437}],[{"start":{"row":279,"column":39},"end":{"row":279,"column":40},"action":"insert","lines":[","],"id":2438}],[{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"insert","lines":[" "],"id":2439}],[{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"remove","lines":[" "],"id":2440}],[{"start":{"row":279,"column":41},"end":{"row":279,"column":42},"action":"insert","lines":[","],"id":2441}],[{"start":{"row":279,"column":42},"end":{"row":279,"column":43},"action":"insert","lines":[" "],"id":2442}],[{"start":{"row":279,"column":42},"end":{"row":279,"column":43},"action":"remove","lines":[" "],"id":2443}],[{"start":{"row":279,"column":39},"end":{"row":279,"column":40},"action":"remove","lines":[","],"id":2444}],[{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"remove","lines":[","],"id":2445}],[{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"insert","lines":[","],"id":2446}],[{"start":{"row":279,"column":41},"end":{"row":279,"column":42},"action":"insert","lines":[" "],"id":2447},{"start":{"row":279,"column":42},"end":{"row":279,"column":43},"action":"insert","lines":["r"]},{"start":{"row":279,"column":43},"end":{"row":279,"column":44},"action":"insert","lines":["e"]},{"start":{"row":279,"column":44},"end":{"row":279,"column":45},"action":"insert","lines":["c"]},{"start":{"row":279,"column":45},"end":{"row":279,"column":46},"action":"insert","lines":["i"]},{"start":{"row":279,"column":46},"end":{"row":279,"column":47},"action":"insert","lines":["p"]},{"start":{"row":279,"column":47},"end":{"row":279,"column":48},"action":"insert","lines":["e"]}],[{"start":{"row":279,"column":48},"end":{"row":279,"column":49},"action":"insert","lines":["i"],"id":2448},{"start":{"row":279,"column":49},"end":{"row":279,"column":50},"action":"insert","lines":["d"]}],[{"start":{"row":279,"column":48},"end":{"row":279,"column":49},"action":"insert","lines":["_"],"id":2450}],[{"start":{"row":279,"column":51},"end":{"row":279,"column":52},"action":"insert","lines":["-"],"id":2451}],[{"start":{"row":279,"column":51},"end":{"row":279,"column":52},"action":"remove","lines":["-"],"id":2452}],[{"start":{"row":279,"column":51},"end":{"row":279,"column":52},"action":"insert","lines":["="],"id":2453}],[{"start":{"row":279,"column":52},"end":{"row":279,"column":53},"action":"insert","lines":["n"],"id":2454},{"start":{"row":279,"column":53},"end":{"row":279,"column":54},"action":"insert","lines":["e"]},{"start":{"row":279,"column":54},"end":{"row":279,"column":55},"action":"insert","lines":["w"]}],[{"start":{"row":279,"column":52},"end":{"row":279,"column":55},"action":"remove","lines":["new"],"id":2455},{"start":{"row":279,"column":52},"end":{"row":279,"column":62},"action":"insert","lines":["new_recipe"]}],[{"start":{"row":279,"column":62},"end":{"row":279,"column":63},"action":"insert","lines":["."],"id":2456}],[{"start":{"row":279,"column":63},"end":{"row":279,"column":64},"action":"insert","lines":["i"],"id":2457},{"start":{"row":279,"column":64},"end":{"row":279,"column":65},"action":"insert","lines":["n"]},{"start":{"row":279,"column":65},"end":{"row":279,"column":66},"action":"insert","lines":["s"]},{"start":{"row":279,"column":66},"end":{"row":279,"column":67},"action":"insert","lines":["e"]},{"start":{"row":279,"column":67},"end":{"row":279,"column":68},"action":"insert","lines":["r"]},{"start":{"row":279,"column":68},"end":{"row":279,"column":69},"action":"insert","lines":["t"]},{"start":{"row":279,"column":69},"end":{"row":279,"column":70},"action":"insert","lines":["e"]},{"start":{"row":279,"column":70},"end":{"row":279,"column":71},"action":"insert","lines":["d"]},{"start":{"row":279,"column":71},"end":{"row":279,"column":72},"action":"insert","lines":["_"]}],[{"start":{"row":279,"column":72},"end":{"row":279,"column":73},"action":"insert","lines":["i"],"id":2458},{"start":{"row":279,"column":73},"end":{"row":279,"column":74},"action":"insert","lines":["d"]}],[{"start":{"row":279,"column":41},"end":{"row":279,"column":74},"action":"remove","lines":[" recipe_id=new_recipe.inserted_id"],"id":2459},{"start":{"row":279,"column":40},"end":{"row":279,"column":41},"action":"remove","lines":[","]}],[{"start":{"row":274,"column":8},"end":{"row":274,"column":21},"action":"remove","lines":["new_recipe = "],"id":2460}],[{"start":{"row":265,"column":48},"end":{"row":265,"column":49},"action":"insert","lines":["."],"id":2461},{"start":{"row":265,"column":49},"end":{"row":265,"column":50},"action":"insert","lines":["l"]},{"start":{"row":265,"column":50},"end":{"row":265,"column":51},"action":"insert","lines":["o"]},{"start":{"row":265,"column":51},"end":{"row":265,"column":52},"action":"insert","lines":["w"]},{"start":{"row":265,"column":52},"end":{"row":265,"column":53},"action":"insert","lines":["e"]},{"start":{"row":265,"column":53},"end":{"row":265,"column":54},"action":"insert","lines":["r"]},{"start":{"row":265,"column":54},"end":{"row":265,"column":55},"action":"insert","lines":["("]},{"start":{"row":265,"column":55},"end":{"row":265,"column":56},"action":"insert","lines":[")"]},{"start":{"row":265,"column":56},"end":{"row":265,"column":57},"action":"insert","lines":[")"]}],[{"start":{"row":265,"column":56},"end":{"row":265,"column":57},"action":"remove","lines":[")"],"id":2462}],[{"start":{"row":264,"column":53},"end":{"row":264,"column":54},"action":"insert","lines":["."],"id":2463}],[{"start":{"row":264,"column":53},"end":{"row":264,"column":54},"action":"remove","lines":["."],"id":2464}],[{"start":{"row":264,"column":52},"end":{"row":264,"column":53},"action":"insert","lines":["."],"id":2465},{"start":{"row":264,"column":53},"end":{"row":264,"column":54},"action":"insert","lines":["l"]},{"start":{"row":264,"column":54},"end":{"row":264,"column":55},"action":"insert","lines":["o"]},{"start":{"row":264,"column":55},"end":{"row":264,"column":56},"action":"insert","lines":["w"]},{"start":{"row":264,"column":56},"end":{"row":264,"column":57},"action":"insert","lines":["e"]},{"start":{"row":264,"column":57},"end":{"row":264,"column":58},"action":"insert","lines":["r"]},{"start":{"row":264,"column":58},"end":{"row":264,"column":59},"action":"insert","lines":["("]},{"start":{"row":264,"column":59},"end":{"row":264,"column":60},"action":"insert","lines":[")"]}],[{"start":{"row":263,"column":50},"end":{"row":263,"column":58},"action":"insert","lines":[".lower()"],"id":2466}],[{"start":{"row":262,"column":52},"end":{"row":262,"column":60},"action":"insert","lines":[".lower()"],"id":2467}],[{"start":{"row":261,"column":44},"end":{"row":261,"column":52},"action":"insert","lines":[".lower()"],"id":2468}],[{"start":{"row":257,"column":54},"end":{"row":257,"column":62},"action":"insert","lines":[".lower()"],"id":2469}],[{"start":{"row":256,"column":54},"end":{"row":256,"column":62},"action":"insert","lines":[".lower()"],"id":2470}],[{"start":{"row":254,"column":44},"end":{"row":254,"column":52},"action":"insert","lines":[".lower()"],"id":2471}],[{"start":{"row":258,"column":48},"end":{"row":258,"column":56},"action":"insert","lines":[".lower()"],"id":2472}],[{"start":{"row":277,"column":45},"end":{"row":277,"column":46},"action":"insert","lines":["i"],"id":2473}],[{"start":{"row":240,"column":37},"end":{"row":240,"column":38},"action":"insert","lines":["/"],"id":2474}],[{"start":{"row":265,"column":47},"end":{"row":265,"column":55},"action":"insert","lines":[".lower()"],"id":2492}],[{"start":{"row":265,"column":48},"end":{"row":265,"column":56},"action":"remove","lines":[".lower()"],"id":2492}],[{"start":{"row":264,"column":51},"end":{"row":264,"column":59},"action":"insert","lines":[".lower()"],"id":2493}],[{"start":{"row":264,"column":52},"end":{"row":264,"column":60},"action":"remove","lines":[".lower()"],"id":2494}],[{"start":{"row":263,"column":49},"end":{"row":263,"column":57},"action":"insert","lines":[".lower()"],"id":2495}],[{"start":{"row":263,"column":50},"end":{"row":263,"column":58},"action":"remove","lines":[".lower()"],"id":2496}],[{"start":{"row":262,"column":51},"end":{"row":262,"column":59},"action":"insert","lines":[".lower()"],"id":2497}],[{"start":{"row":262,"column":52},"end":{"row":262,"column":60},"action":"remove","lines":[".lower()"],"id":2498}],[{"start":{"row":261,"column":43},"end":{"row":261,"column":51},"action":"insert","lines":[".lower()"],"id":2499}],[{"start":{"row":261,"column":44},"end":{"row":261,"column":52},"action":"remove","lines":[".lower()"],"id":2500}],[{"start":{"row":258,"column":47},"end":{"row":258,"column":55},"action":"insert","lines":[".lower()"],"id":2501}],[{"start":{"row":258,"column":48},"end":{"row":258,"column":56},"action":"remove","lines":[".lower()"],"id":2502}],[{"start":{"row":257,"column":53},"end":{"row":257,"column":61},"action":"insert","lines":[".lower()"],"id":2503}],[{"start":{"row":257,"column":54},"end":{"row":257,"column":62},"action":"remove","lines":[".lower()"],"id":2504}],[{"start":{"row":256,"column":53},"end":{"row":256,"column":61},"action":"insert","lines":[".lower()"],"id":2505}],[{"start":{"row":256,"column":54},"end":{"row":256,"column":62},"action":"remove","lines":[".lower()"],"id":2506}],[{"start":{"row":254,"column":43},"end":{"row":254,"column":51},"action":"insert","lines":[".lower()"],"id":2507}],[{"start":{"row":254,"column":44},"end":{"row":254,"column":52},"action":"remove","lines":[".lower()"],"id":2508}]]},"ace":{"folds":[],"scrolltop":3580,"scrollleft":0,"selection":{"start":{"row":279,"column":41},"end":{"row":279,"column":41},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":254,"state":"start","mode":"ace/mode/python"}},"timestamp":1562703347597}