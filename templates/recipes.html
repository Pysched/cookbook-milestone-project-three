{% extends "base.html" %}
{% block content %}

<!--Page Title - Recipe Name-->
<div class="row center-align">
    <div class="col s12">
        <h1 class="title">{{ recipe.name | title }}</h1>
    </div>
</div>

<!--RECIPE CARD - IMAGE AND GENERAL DETAILS-->
<div class="row center-align">

    <!--Recipe Image, Stats and Buttons Card-->
    <div class="row card z-depth-1">
        <!--Recipe Image-->
        <div class="col s12 m6 center-align recipe-img">
            <img class="responsive-img" alt="{{ recipe.name }}"src="{{ url_for('static', filename=recipe.img) }}">
        </div>
        <!--Recipe Stats-->
        <div class="col s12 m6 center-align recipe-details">
            <p class="stat">
                Rating: 
                {% set rating = [] %}
                {% for r in recipe.rating_values %}
                    {% if rating.append(r) %}
                    {% endif %}
                {% endfor %}
                {{ (rating | sum / rating | count) | int }}/5
            </p>
            <p class="stat">
                Times Rated: {{ rating | count }}
            </p>
            <a href="#rate_modal" class="waves-effect waves-light btn modal-trigger">
                <i class="far fa-star" aria-hidden="true"></i>Rate It
            </a>
            <p class="stat">
                Prep Time: {{ recipe.prep_time }}
            </p>
            <p class="stat">
                Cook Time: {{ recipe.cook_time }}
            </p>
            <p class="stat">
                Serves: {{ recipe.serves | capitalize }}
            </p>
            <p class="stat">
                By: {{ recipe.author | title }}
            </p>
            <p class="stat">
                Added: {{ recipe.added_date }}
            </p>
        </div>
        <div class="col s12 center-align options-buttons">
            
        </div>
    </div>

</div>

<!--Rate It Modal-->
<div id="rate_modal" class="modal">
    <div class="modal-content center-align">
        <form method="GET" action="">    
            <div class="input-field col s12">
                <select id="rating" name="rating" class="form-control validate" required>
                    <option disabled selected>Rating</option>
                    {% for r in ratings %}
                    <option value="{{ r }}">{{ r }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="input-field col s12">
                <button class="btn waves-effect waves-light" type="submit" name="register">
                    <i class="far fa-star"></i>
                    Rate It
                </button>
            </div>
        </form>
    </div>
</div>

{% endblock %}