{% extends "base.html" %}
{% block content %}

<!--Page Title - Recipe Name-->
<div class="row center-align">
    <div class="col s12">
        <h1 class="page-title">{{ username | capitalize }}'s Profile</h1>
    </div>
</div>

<div class="row">

    <!--User's Recipes-->
    <div class="row recipe-card card z-depth-1">
        <div class="col s12 center-align">
            <h3 class="card-title">My Recipes</h3>
        </div>
        <div class="col s12">
            <ul class="collection collection-wrapper">
                <!--If the user has added recipes, these will be displayed as a list-->
                {% for added in user_added_list %}
                    <li class="collection-item avatar">
                        <a href="{{ url_for('recipe', recipe_id=added._id) }}">
                            <img src="{{ url_for('static', filename=added.img) }}" alt="{{ added.name | title }}" class="circle">
                            <span class="title">{{ added.name | title }}</span>
                        </a>
                    </li>
                <!--If the user hasn't added any recipes, they will be invited to add a recipe-->
                {% else %}
                    <li class="collection-item avatar center-align">
                        <p>
                            You haven't added any recipes yet.
                            <br>
                            <a href="{{ url_for('add_recipe') }}">
                                Add a recipe
                            </a>
                             to get started.
                        </p>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    
    <!--User's Liked Recipes-->
    <div class="row recipe-card card z-depth-1">
        <div class="col s12 center-align">
            <h3 class="card-title">Liked Recipes</h3>
        </div>
        <div class="col s12">
            <ul class="collection collection-wrapper">
                <!--If the user has liked recipes, these will be displayed as a list-->
                {% for liked in user_liked_list %}
                    <div class="row">
                        <div class="col s9 link-wrapper">
                            <li class="collection-item avatar">
                                <a href="{{ url_for('recipe', recipe_id=liked._id) }}">
                                    <img src="{{ url_for('static', filename=liked.img) }}" alt="{{ liked.name | title }}" class="circle">
                                    <span class="title">{{ liked.name | title }}</span>
                                </a>
                        </div>
                        <div class="col s3 like-wrapper">
                                <a href="{{ url_for('unlike_recipe', recipe_id=liked._id) }}" class="waves-effect waves-light btn liked-btn">
                                    <i class="fas fa-thumbs-up" aria-hidden="true"></i>
                                    <span class="hide-on-small-and-down">Liked</span>
                                </a>
                            </li>
                        </div>
                    </div>
                <!--If the user hasn't liked any recipes, they will be invited to browse recipes-->
                {% else %}
                    <li class="collection-item avatar center-align">
                        <p>
                            You haven't liked any recipes yet.
                            <br>
                            <a href="{{ url_for('get_recipes', page=1) }}">
                                Browse
                            </a>
                             our recipe collection to get started.
                        </p>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    
    <!--Account Management Buttons-->
    <div class="row recipe-card card z-depth-1 center-align">
        <div class="col s12">
            <h4 class="card-title">Account Management</h4>
        </div>
        <div class="col s12 m5 offset-m1 acc-management-wrapper">
            <!--Change Password Modal Button-->
            <a href="#change_password_modal" class="waves-effect waves-light btn modal-trigger change-pwd-btn">
                <i class="fas fa-user-lock" aria-hidden="true"></i>
                Change Password
            </a>
        </div>
        <div class="col s12 m5 acc-management-wrapper">
            <!--Delete Account Modal Button-->
            <a href="#delete_account_modal" class="waves-effect waves-light btn modal-trigger delete-acc-btn">
                <i class="fas fa-user-slash" aria-hidden="true"></i>
                Delete Account
            </a>
        </div>
    </div>

</div>

<!--Change Password Modal-->
<div id="change_password_modal" class="modal">
    <div class="modal-content center-align">
        <h4 class="title">Change Password</h4>
        <form class="col s12" method="POST" action="{{ url_for('change_password', username=username) }}">
            <div class="row modal-form-wrapper">
                <!--Existing Password-->
                <div class="input-field col s12">
                    <i class="fas fa-lock prefix" aria-hidden="true"></i>
                    <input id="existing_password" name="existing_password" type="password" class="form-control validate" minlength="6" maxlength="15" required>
                    <label for="existing_password">Existing Password</label>
                </div>
                <!--New Password-->
                <div class="input-field col s12">
                    <i class="fas fa-key prefix" aria-hidden="true"></i>
                    <input id="changed_password" name="changed_password" type="password" class="form-control validate" minlength="6" maxlength="15" required>
                    <label for="changed_password">New Password</label>
                </div>
            </div>
            <div class="row modal-btn-wrapper">
                <!--Change Password Button-->
                <button class="btn waves-effect waves-light change-pwd-btn" type="submit">
                    Change Password
                    <i class="fas fa-user-lock"></i>
                </button>
            </div>
        </form>
    </div>
</div>

<!--Delete Modal-->
<div id="delete_account_modal" class="modal">
    <div class="modal-content center-align">
        <h4 class="title">Delete Account</h4>
        <h6 class="helper">Are you sure you want to delete your account?</h6>
        <p class="helper italic">
            All your recipes and data will be permanently deleted if you go ahead!
            <br>
            Confirm your password to continue...
        </p>
        <form class="col s12" method="POST" action="{{ url_for('delete_account', username=username) }}">
            <div class="row modal-form-wrapper">
                <!--Existing Password-->
                <div class="input-field col s12">
                    <i class="fas fa-lock prefix" aria-hidden="true"></i>
                    <input id="confirm_password" name="confirm_password" type="password" class="form-control validate" minlength="6" maxlength="15" required>
                    <label for="existing_password">Confirm Password</label>
                </div>
            </div>
            <div class="row modal-btn-wrapper">
                <!--Change Password Button-->
                <button class="btn waves-effect waves-light delete-acc-btn" type="submit">
                    Delete Account
                    <i class="fas fa-user-slash"></i>
                </button>
            </div>
        </form>
    </div>
</div>

{% endblock %}